<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Whatdyawant?</title>
    <!-- Supabase JS CDN, place this before your own scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.5/dist/umd/supabase.min.js"></script>
    <script src="supabase.js"></script>
   <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f9fafb;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: white;
            border-right: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            z-index: 100;
        }

        .sidebar-header {
            padding: 24px;
            border-bottom: 1px solid #e5e7eb;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .logo h1 {
            font-size: 20px;
            color: #111827;
            font-weight: 700;
        }

        .sidebar-nav {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 8px;
            color: #374151;
            text-decoration: none;
            margin-bottom: 4px;
            transition: all 0.2s;
            font-weight: 500;
        }

        .nav-item:hover {
            background: #dcfce7;
            color: #15803d;
        }

        .nav-item.active {
            background: #dcfce7;
            color: #15803d;
            font-weight: 600;
        }

        .nav-icon {
            font-size: 20px;
        }

        .sidebar-footer {
            padding: 16px;
            border-top: 1px solid #e5e7eb;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 16px;
        }

        .user-info {
            flex: 1;
            min-width: 0;
        }

        .user-name {
            font-weight: 600;
            color: #111827;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .user-email {
            font-size: 12px;
            color: #6b7280;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .footer-buttons {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            background: white;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            color: #374151;
            text-decoration: none;
        }

        .btn-small:hover {
            background: #f9fafb;
            border-color: #d1d5db;
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            padding: 32px;
            min-height: 100vh;
        }

        .page-header {
            margin-bottom: 32px;
        }

        .page-header h2 {
            font-size: 32px;
            color: #111827;
            margin-bottom: 8px;
        }

        .page-header p {
            color: #111827;
            font-size: 16px;
        }
        .welcome-message {
            background: white;
            border-radius: 16px;
            border: 1px solid #e5e7eb;
            padding: 32px;
            margin-bottom: 32px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.03);
        }
        .welcome-message h2 {
            margin-bottom: 10px;
            font-size: 28px;
            color: #111827;
        }
        .welcome-message .updates h4 {
            margin-top: 20px;
            margin-bottom: 6px;
            color: #111827;
            font-size: 16px;
        }
        .welcome-message ul {
            margin-left: 18px;
            margin-bottom: 12px;
            color: #6b7280;
            font-size: 15px;
        }
        /* Dashboard Cards */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .dashboard-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            border: 1px solid #e5e7eb;
            transition: all 0.3s;
            cursor: pointer;
        }

        .dashboard-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1);
            border-color: #16a34a;
        }

        .card-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 16px;
        }

        .card-icon.green {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
        }

        .card-icon.blue {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
        }

        .card-icon.purple {
            background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%);
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 8px;
        }

        .card-description {
            color: #6b7280;
            font-size: 14px;
            line-height: 1.5;
        }

        /* Share Section */
        .share-section {
            background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
            border-radius: 16px;
            padding: 32px;
            color: white;
            margin-bottom: 32px;
        }

        .share-section h3 {
            font-size: 24px;
            margin-bottom: 12px;
        }

        .share-section p {
            opacity: 0.9;
            margin-bottom: 24px;
            font-size: 15px;
        }

        .share-box {
            display: flex;
            gap: 12px;
        }

        .share-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
            font-family: monospace;
        }

        .share-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .btn-share {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            background: white;
            color: #16a34a;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .btn-share:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        /* Mobile Menu */
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 200;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: white;
            border: 1px solid #e5e7eb;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s;
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: 80px 20px 20px;
            }

            .mobile-menu-btn {
                display: flex;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .share-box {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Mobile Menu Button -->
    <button class="mobile-menu-btn" onclick="toggleSidebar()">‚ò∞</button>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <div class="logo-icon">üéÅ</div>
                <h1>Whatdyawant?</h1>
            </div>
        </div>

        <nav class="sidebar-nav">
            <a href="dashboard.html" class="nav-item active">
                <span class="nav-icon">üè†</span>
                <span>Dashboard</span>
            </a>
            <a href="my-wishlist.html" class="nav-item">
                <span class="nav-icon">‚ù§Ô∏è</span>
                <span>My Wishlist</span>
            </a>
            <a href="friends-wishlists.html" class="nav-item">
                <span class="nav-icon">üë•</span>
                <span>Friends' Wishlists</span>
            </a>
            <a href="shopping-list.html" class="nav-item">
                <span class="nav-icon">üõçÔ∏è</span>
                <span>My Shopping List</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <div class="user-profile">
                <div class="avatar" id="userAvatar">U</div>
                <div class="user-info">
                    <div class="user-name" id="userName">User</div>
                    <div class="user-email" id="userEmail">user@email.com</div>
                </div>
            </div>
            <div class="footer-buttons">
                <a href="settings.html" class="btn-small">
                    ‚öôÔ∏è Settings
                </a>
                <button class="btn-small" onclick="logout()">
                    üö™ Logout
                </button>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="page-header">
            <h2>Welcome Back! üëã</h2>
            <p>Manage your wishlist and see what your friends want</p>
        </div>

    <!-- Welcome Message Section -->
        <div class="welcome-message">
            <h2>üëã Welcome to Whatdyawant?</h2>
            <p>
                This app helps you create, share, and claim gifts from wishlists with friends. 
                Your wishlist is shared with whomever you chose, they are able to save your wishlist and see updates. 
                You are unable to see if anybody has claimed your gifts and any claims are anonymous!
            </p>
            <div class="updates">
                <h4>Latest Features:</h4>
                <ul>
                    <li>üéÅ Add and edit wishlist items</li>
                    <li>üîé Search and save friends' wishlists</li>
                    <li>üõçÔ∏è Shopping list for gifts you've claimed</li>
                    <li>‚úÖ Mark gifts as purchased</li>
                    <li>üíæ Save a wishlist link you were sent</li>
                </ul>
                <h4>Coming soon:</h4>
                <ul>
                    <li>üîó Autofill product details from pasted URLs</li>
                    <li>üñºÔ∏è Wishlist cover images and item photos</li>
                    <li>üì± Improved mobile experience</li>
                    <li>‚úÖ Filters and Categories</li>
                </ul>
            </div>
        </div>

        <!-- Share Wishlist Section -->
        <div class="share-section">
            <h3>Share Your Wishlist</h3>
            <p>Copy this link and share it with friends and family so they can see your wishes!</p>
            <div class="share-box">
                <input type="text" class="share-input" id="shareLink" readonly value="https://whatdyawant.app/wishlist-view.html?friend=your-unique-id">
                <button class="btn-share" onclick="copyShareLink()">üìã Copy Link</button>
            </div>
        </div>

        <!-- Dashboard Cards -->
        <div class="dashboard-grid">
            <div class="dashboard-card" onclick="location.href='my-wishlist.html'">
                <div class="card-icon green">‚ù§Ô∏è</div>
                <div class="card-title">My Wishlist</div>
                <div class="card-description">
                    Add, edit, and manage the items you'd love to receive. Your friends can claim them without you knowing!
                </div>
            </div>

            <div class="dashboard-card" onclick="location.href='friends-wishlists.html'">
                <div class="card-icon blue">üë•</div>
                <div class="card-title">Friends' Wishlists</div>
                <div class="card-description">
                    Browse and save your friends' wishlists. See what they want and claim gifts for them.
                </div>
            </div>

            <div class="dashboard-card" onclick="location.href='shopping-list.html'">
                <div class="card-icon purple">üõçÔ∏è</div>
                <div class="card-title">My Shopping List</div>
                <div class="card-description">
                    View all the gifts you've claimed for others. Track your budget and mark items as purchased.
                </div>
            </div>
        </div>
    </main>

    <script>
                // Load user data from Supabase
        window.addEventListener('DOMContentLoaded', async function() {
            const { data: { user }, error } = await supabase.auth.getUser();

            if (!user) {
                window.location.href = 'login.html';
                return;
            }

            const userMeta = user.user_metadata || {};
            const fullName = userMeta.fullName || user.email.split('@')[0];
            const username = userMeta.username || user.email.split('@')[0];
            const userEmail = user.email;

            // Set Avatar and Share Link 
            document.getElementById('userName').textContent = fullName;
            document.getElementById('userEmail').textContent = userEmail;
            document.getElementById('userAvatar').textContent = fullName[0].toUpperCase();
            document.getElementById('shareLink').value = `https://josieproto0.github.io/whatdyawant/wishlist-view.html?friend=${username}`;
        });

        // Toggle sidebar on mobile
    function toggleSidebar() {  
    document.getElementById('sidebar').classList.toggle('active');
}

        // Copy share link
        function copyShareLink() {
            const shareLink = document.getElementById('shareLink');
            shareLink.select();
            shareLink.setSelectionRange(0, 99999); // For mobile

            navigator.clipboard.writeText(shareLink.value).then(function() {
                alert('‚úì Link copied to clipboard!');
            }).catch(function() {
                document.execCommand('copy');
                alert('‚úì Link copied to clipboard!');
            });
        }

        // Logout function
        async function logout() {
            if (confirm('Are you sure you want to logout?')) {
                await supabase.auth.signOut();
                window.location.href = 'login.html';
            }
        }

        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', function(e) {
            const sidebar = document.getElementById('sidebar');
            const menuBtn = document.querySelector('.mobile-menu-btn');

            if (window.innerWidth <= 768) {
                if (!sidebar.contains(e.target) && !menuBtn.contains(e.target)) {
                    sidebar.classList.remove('active');
                }
            }
        });
        </script>
</body>
</html>
